local variable 'curr_D' referenced before assignment